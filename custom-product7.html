<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customize Couple Candles</title>
    <link rel="stylesheet" href="../css/custom.css">
    <style>
        .customize-container {
            max-width: 500px;
            margin: 40px auto;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 12px #eee;
            padding: 32px 24px;
        }
        .customize-container h2 {
            margin-bottom: 24px;
        }
        .customize-container label {
            display: block;
            margin: 18px 0 6px 0;
            font-weight: bold;
        }
        .customize-container input[type="text"],
        .customize-container select,
        .customize-container input[type="number"],
        .customize-container textarea {
            width: 100%;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        .customize-container textarea {
            min-height: 60px;
            resize: vertical;
        }
        .customize-container .preview {
            margin: 24px 0;
            text-align: center;
        }
        .customize-container button {
            background: #400;
            color: #fff;
            border: none;
            border-radius: 6px;
            padding: 10px 28px;
            font-size: 1em;
            cursor: pointer;
            margin-top: 10px;
        }
        .customize-container button:hover {
            background: #300;
        }
        .price-label {
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 18px;
            color: #400;
            text-align: right;
            display: block;
        }
    </style>
</head>
<body>
    <div class="customize-container">
        <h2>Customize Couple Candles</h2>
        <form id="customForm" oninput="updatePrice()">
            <label for="color">Color</label>
            <select id="color" name="color">
                <option value="#ffffff" data-original="true">White (Original)</option>
                <option value="#ffcc00">Yellow</option>
                <option value="#ff6666">Red</option>
                <option value="#beige">Beige</option>
                <option value="#e0cda9">Cream</option>
                <option value="#d1b3c4">Pink</option>
                <option value="#a3c1ad">Mint</option>
                <option value="#b0e0e6">Powder Blue</option>
                <option value="#f5e6e8">Blush</option>
                <option value="#f7cac9">Rose Quartz</option>
                <option value="#b39eb5">Lavender</option>
                <option value="#ffe4b5">Moccasin</option>
                <option value="#f4a460">Sandy Brown</option>
                <option value="#deb887">Burly Wood</option>
                <option value="#c0c0c0">Silver</option>
                <option value="#000000">Black</option>
                <option value="#8b4513">Chocolate Brown</option>
                <option value="#ffd700">Gold</option>
                <option value="#c0c0c0">Platinum</option>
                <option value="#800080">Purple</option>
                <option value="#008000">Green</option>
                <option value="#00ced1">Turquoise</option>
                <option value="#ffa07a">Light Salmon</option>
                <option value="#ffb6c1">Light Pink</option>
                <option value="#4682b4">Steel Blue</option>
                <option value="#ffdab9">Peach Puff</option>
                <option value="#b22222">Firebrick</option>
                <option value="#e9967a">Dark Salmon</option>
                <option value="#f0e68c">Khaki</option>
                <option value="#add8e6">Light Blue</option>
            </select>

            <label for="size">Size (cm)</label>
            <select id="size" name="size">
                <option value="Small" data-size="1">Small (5x5)</option>
                <option value="Medium" data-size="2">Medium (7x7)</option>
                <option value="Large" data-size="3">Large (10x10)</option>
            </select>

            <label for="scent">Scent</label>
            <select id="scent" name="scent">
                <optgroup label="Floral Scents">
                    <option value="Lavender Fields">Lavender Fields</option>
                    <option value="Rose Petals">Rose Petals</option>
                    <option value="Jasmine Blossom">Jasmine Blossom</option>
                    <option value="Gardenia Bloom">Gardenia Bloom</option>
                    <option value="Honeysuckle Vine">Honeysuckle Vine</option>
                </optgroup>
                <optgroup label="Fruity Scents">
                    <option value="Citrus Zest">Citrus Zest (Orange, Lemon, Lime)</option>
                    <option value="Wild Berries">Wild Berries</option>
                    <option value="Mango & Papaya">Mango & Papaya</option>
                    <option value="Apple Cinnamon">Apple Cinnamon</option>
                    <option value="Pineapple Coconut">Pineapple Coconut</option>
                </optgroup>
                <optgroup label="Sweet & Gourmand Scents">
                    <option value="Vanilla Bean">Vanilla Bean</option>
                    <option value="Salted Caramel">Salted Caramel</option>
                    <option value="Chocolate Fudge">Chocolate Fudge</option>
                    <option value="Pumpkin Spice">Pumpkin Spice</option>
                    <option value="Sugar Cookie">Sugar Cookie</option>
                </optgroup>
                <optgroup label="Earthy & Woody Scents">
                    <option value="Sandalwood">Sandalwood</option>
                    <option value="Cedarwood & Amber">Cedarwood & Amber</option>
                    <option value="Oakmoss">Oakmoss</option>
                    <option value="Patchouli Rain">Patchouli Rain</option>
                    <option value="Forest Pine">Forest Pine</option>
                </optgroup>
                <optgroup label="Fresh & Clean Scents">
                    <option value="Fresh Linen">Fresh Linen</option>
                    <option value="Ocean Breeze">Ocean Breeze</option>
                    <option value="Morning Dew">Morning Dew</option>
                    <option value="Eucalyptus Mint">Eucalyptus Mint</option>
                    <option value="Cucumber Melon">Cucumber Melon</option>
                </optgroup>
                <optgroup label="Spicy & Warm Scents">
                    <option value="Clove & Nutmeg">Clove & Nutmeg</option>
                    <option value="Tobacco & Leather">Tobacco & Leather</option>
                    <option value="Black Pepper & Vetiver">Black Pepper & Vetiver</option>
                    <option value="Frankincense & Myrrh">Frankincense & Myrrh</option>
                    <option value="Fireside Smoke">Fireside Smoke</option>
                </optgroup>
            </select>

            <label for="quantity">Quantity</label>
            <select id="quantity" name="quantity">
                <option value="1">1 pack (2 candles)</option>
                <option value="2">2 packs (4 candles)</option>
                <option value="3">3 packs (6 candles)</option>
                <option value="4">4 packs (8 candles)</option>
                <option value="5">5 packs (10 candles)</option>
                <option value="6">6 packs (12 candles)</option>
                <option value="7">7 packs (14 candles)</option>
                <option value="8">8 packs (16 candles)</option>
                <option value="9">9 packs (18 candles)</option>
                <option value="10">10 packs (20 candles)</option>
            </select>

            <label for="text1">Custom Text for Candle 1</label>
            <textarea id="text1" name="text1" maxlength="100" placeholder="e.g. Together"></textarea>

            <label for="text2">Custom Text for Candle 2</label>
            <textarea id="text2" name="text2" maxlength="100" placeholder="e.g. Forever"></textarea>

            <span class="price-label" style="display:block;text-align:center;margin-top:18px;">
                Price: â‚¹<span id="price">700</span> <span style="font-weight:normal;">per pack (2 candles)</span>
            </span>

            <div class="preview" id="preview">
                <img id="candlePreview" src="../images/c7.webp" alt="Candle Preview" style="width:120px;height:120px;border-radius:8px;background:#eee;">
                <div id="previewText" style="margin-top:10px;font-weight:bold;"></div>
            </div>

            <button type="button" id="saveCustomizationBtn">Save Customization</button>
        </form>
    </div>
    <script>
        // Color preview
        document.getElementById('color').addEventListener('change', function() {
            document.getElementById('candlePreview').style.background = this.value;
        });

        // Text preview (show both texts)
        function updatePreviewText() {
            const t1 = document.getElementById('text1').value;
            const t2 = document.getElementById('text2').value;
            document.getElementById('previewText').textContent = t1 && t2 ? t1 + " | " + t2 : t1 || t2;
        }
        document.getElementById('text1').addEventListener('input', updatePreviewText);
        document.getElementById('text2').addEventListener('input', updatePreviewText);

        // Price calculation
        function updatePrice() {
            // Base price per pack (2 candles)
            let basePrice = 700;
            // Color price
            const colorSelect = document.getElementById('color');
            const colorIndex = colorSelect.selectedIndex;
            let extra = 0;
            if (colorIndex !== 0) {
                extra += 150; // All other colors +150 per pack
            }

            // Size price (Small=1, Medium=2, Large=3)
            const sizeSelect = document.getElementById('size');
            const sizeIndex = sizeSelect.selectedIndex;
            extra += sizeIndex * 200;

            // Scent price (all scents 200 per pack)
            extra += 200;

            // Custom text price (if any text in either box, add 400 per pack)
            const text1 = document.getElementById('text1').value;
            const text2 = document.getElementById('text2').value;
            if (text1.trim().length > 0 || text2.trim().length > 0) extra += 400;

            // Quantity multiplier (1 pack = 2 candles)
            const quantity = parseInt(document.getElementById('quantity').value, 10) || 1;
            let price = (basePrice + extra) * quantity;

            document.getElementById('price').innerText = price;
        }
        // Initial price and preview
        updatePrice();
        updatePreviewText();
        document.getElementById('quantity').addEventListener('change', updatePrice);
        document.getElementById('text1').addEventListener('input', updatePrice);
        document.getElementById('text2').addEventListener('input', updatePrice);

        // Add to cart on Save Customization
        document.getElementById('saveCustomizationBtn').addEventListener('click', function() {
            const color = document.getElementById('color').options[document.getElementById('color').selectedIndex].text;
            const size = document.getElementById('size').options[document.getElementById('size').selectedIndex].text;
            const scent = document.getElementById('scent').options[document.getElementById('scent').selectedIndex].text;
            const text1 = document.getElementById('text1').value;
            const text2 = document.getElementById('text2').value;
            const quantity = parseInt(document.getElementById('quantity').value, 10) || 1;
            const price = parseInt(document.getElementById('price').innerText, 10);
            const image = document.getElementById('candlePreview').src;

            let cartKey = 'cart';
            const userInfo = JSON.parse(localStorage.getItem('userInfo'));
            if (userInfo && userInfo.email) {
                cartKey = 'cart_' + userInfo.email;
            }
            let cart = JSON.parse(localStorage.getItem(cartKey)) || [];

            const existingProduct = cart.find(item =>
                item.name === `Couple Candles (${color}, ${size}, ${scent})` &&
                item.customText1 === text1 &&
                item.customText2 === text2
            );
            if (existingProduct) {
                existingProduct.quantity += quantity;
            } else {
                cart.push({
                    name: `Couple Candles (${color}, ${size}, ${scent})`,
                    color,
                    size,
                    scent,
                    customText1: text1,
                    customText2: text2,
                    price,
                    image,
                    quantity
                });
            }
            localStorage.setItem(cartKey, JSON.stringify(cart));
            alert('Customization saved and added to cart!');
        });
    </script>
</body>
</html>
